<!DOCTYPE html>
<html lang="en">
    <head>
    	<title>Beta login</title>
        <link href="css/main.css" rel="stylesheet">
    </head>
    <body>
        <div role="main" class="main-container">
            <div class="center">
                <h1>Login</h1>
            </div>
            <div class="container color-main2 center">
            	<form>
            	<input class="container-item-sm center input-login" type="text" id="username" placeholder="username"><br>
            	<input class="container-item-sm center input-login" type="password" id="passwd" placeholder="password"><br>
            	<button type="button" class="button color-bold1 container-item-md" onclick="loginAttempt()">Submit</button>
            	</form>
            </div>
        </div>

        <script>
        function loginAttempt() {
            var uname = document.getElementById("username").value;
            window.localStorage.setItem('username', uname);
            var passwd = document.getElementById("passwd").value;
            var xmlhttp = new XMLHttpRequest();
            //response from middle
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4) {
                	console.log("resp: " + this.responseText);
                    var resp = JSON.parse(this.responseText);
                    if(resp.type == "F"){
                    	alert("Failed login attempt!");
                        return;
                    }
                    if(resp.type == "S"){
                    	window.location = "student.html"
                    }
                    if(resp.type == "T"){
                    	window.location = "instructor.html"
                    }
                }
            };
            xmlhttp.open("POST", "https://web.njit.edu/~smc53/cs490/request-login.php?request=Login&username=" + window.localStorage.getItem('username') + "&password=" + passwd);
            xmlhttp.send();
        };
        </script>
    </body>
</html>
